<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CKM Syndrome Severity Score Calculator</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Apply the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for number input arrows */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4 sm:p-8">

    <div class="bg-white w-full max-w-3xl p-6 sm:p-10 rounded-2xl shadow-xl">
        
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800">CKM Severity Score Calculator</h1>
            <p class="text-gray-500 mt-2">Calculate your continuous Cardiovascular-Kidney-Metabolic Syndrome score.</p>
        </div>

        <!-- Calculator Form -->
        <form id="ckm-form" class="space-y-6">

            <!-- Demographics Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="gender" class="block text-sm font-medium text-gray-700 mb-1">Gender</label>
                    <select id="gender" name="gender" required class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select Gender</option>
                        <option value="men">Male</option>
                        <option value="women">Female</option>
                    </select>
                </div>
                <div>
                    <label for="age" class="block text-sm font-medium text-gray-700 mb-1">Age (20-80)</label>
                    <input type="number" id="age" name="age" placeholder="e.g., 45" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>

            <!-- Clinical Indicators Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="sbp" class="block text-sm font-medium text-gray-700 mb-1">Systolic Blood Pressure (SBP)</label>
                    <input type="number" step="0.1" id="sbp" name="sbp" placeholder="e.g., 120" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label for="wc" class="block text-sm font-medium text-gray-700 mb-1">Waist Circumference (cm)</label>
                    <input type="number" step="0.1" id="wc" name="wc" placeholder="e.g., 90" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label for="fpg" class="block text-sm font-medium text-gray-700 mb-1">Fasting Plasma Glucose (mg/dL)</label>
                    <input type="number" step="0.1" id="fpg" name="fpg" placeholder="e.g., 100" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label for="tg" class="block text-sm font-medium text-gray-700 mb-1">Triglycerides (mg/dL)</label>
                    <input type="number" step="0.1" id="tg" name="tg" placeholder="e.g., 150" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label for="hdlc" class="block text-sm font-medium text-gray-700 mb-1">HDL Cholesterol (mg/dL)</label>
                    <input type="number" step="0.1" id="hdlc" name="hdlc" placeholder="e.g., 50" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label for="egfr" class="block text-sm font-medium text-gray-700 mb-1">eGFR (mL/min/1.73 m²)</label>
                    <input type="number" step="0.1" id="egfr" name="egfr" placeholder="e.g., 90" required class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
            </div>

            <!-- Additional Risk Factors -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="smoking" class="block text-sm font-medium text-gray-700 mb-1">Smoking</label>
                    <select id="smoking" name="smoking" required class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>
                <div>
                    <label for="antidiabetic" class="block text-sm font-medium text-gray-700 mb-1">Antidiabetic Drug</label>
                    <select id="antidiabetic" name="antidiabetic" required class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>
                <div>
                    <label for="antihypertensive" class="block text-sm font-medium text-gray-700 mb-1">Antihypertensive Drug</label>
                    <select id="antihypertensive" name="antihypertensive" required class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>
                <div>
                    <label for="lipidlowering" class="block text-sm font-medium text-gray-700 mb-1">Lipid Lowering Drug</label>
                    <select id="lipidlowering" name="lipidlowering" required class="w-full p-3 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4">
                <button type="reset" id="reset-button" class="w-full p-3 bg-gray-500 text-white rounded-lg font-semibold hover:bg-gray-600 transition duration-300">
                    Reset
                </button>
                <button type="submit" class="w-full p-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                    Calculate Score
                </button>
            </div>
        </form>

        <!-- Error Message Display -->
        <div id="error-message" class="mt-6 text-center text-red-600 font-medium hidden">
            <!-- Error text will be inserted here -->
        </div>

        <!-- Result Display -->
        <div id="result-container" class="mt-8 pt-6 border-t border-gray-200 text-center hidden">
            <h2 class="text-xl font-semibold text-gray-700 mb-2">Your Continuous CKM Score is:</h2>
            <p id="score-display" class="text-6xl font-bold text-blue-600">
                <!-- Score will be inserted here -->
            </p>
        </div>

    </div>

    <!-- JavaScript Logic -->
    <script>
        // Wait for the DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('ckm-form');
            const resultContainer = document.getElementById('result-container');
            const scoreDisplay = document.getElementById('score-display');
            const errorMessage = document.getElementById('error-message');

            // Listen for form submission
            form.addEventListener('submit', (e) => {
                e.preventDefault(); // Prevent page reload

                // Hide previous results/errors
                resultContainer.classList.add('hidden');
                errorMessage.classList.add('hidden');

                // Get values from the form
                const gender = document.getElementById('gender').value;
                const age = parseFloat(document.getElementById('age').value);
                const sbp = parseFloat(document.getElementById('sbp').value);
                const wc = parseFloat(document.getElementById('wc').value);
                const fpg = parseFloat(document.getElementById('fpg').value);
                const tg = parseFloat(document.getElementById('tg').value);
                const hdlc = parseFloat(document.getElementById('hdlc').value);
                const egfr = parseFloat(document.getElementById('egfr').value);
                const smoking = parseInt(document.getElementById('smoking').value, 10);
                const antidiabetic = parseInt(document.getElementById('antidiabetic').value, 10);
                const antihypertensive = parseInt(document.getElementById('antihypertensive').value, 10);
                const lipidlowering = parseInt(document.getElementById('lipidlowering').value, 10);

                // --- Input Validation ---
                if (!gender || isNaN(age) || isNaN(sbp) || isNaN(wc) || isNaN(fpg) || isNaN(tg) || isNaN(hdlc) || isNaN(egfr) || isNaN(smoking) || isNaN(antidiabetic) || isNaN(antihypertensive) || isNaN(lipidlowering)) {
                    showError('Please fill out all fields with valid numbers.');
                    return;
                }

                if (age < 20 || age > 80) {
                    showError('Age must be between 20 and 80 to use these formulas.');
                    return;
                }

                // Removed check for male age < 40, as the new range is 20-59.
                
                // --- Calculation Logic ---
                let score = 0;

                if (gender === 'men') {
                    if (age >= 20 && age <= 59) {
                        // Male Age 20–59 yr
                        score = -0.53 + (0.0012 * sbp) + (0.0014 * wc) + (0.0033 * fpg) +
                                (0.0001 * tg) - (0.0010 * hdlc) - (0.0008 * egfr) + (0.0025 * smoking) + (0.3915 * antidiabetic) +
                                (0.0546 * antihypertensive) + (0.0853 * lipidlowering);
                    } else if (age >= 60 && age <= 80) {
                        // Male Age 60–80 yr
                        score = -0.24 + (0.0002 * sbp) + (0.0011 * wc) + (0.0011 * fpg) +
                                (0.0002 * tg) - (0.0010 * hdlc) - (0.0002 * egfr) + (0.0005 * smoking) + (0.1378 * antidiabetic) +
                                (0.0095 * antihypertensive) + (0.0324 * lipidlowering);
                    }
                } else if (gender === 'women') {
                    if (age >= 20 && age <= 59) {
                        // Female Age 20–59 yr
                        score = -1.08 + (0.0033 * sbp) + (0.0042 * wc) + (0.0048 * fpg) +
                                (0.0005 * tg) - (0.0020 * hdlc) - (0.0021 * egfr) + (0.0122 * smoking) + (0.4964 * antidiabetic) +
                                (0.1568 * antihypertensive) + (0.1837 * lipidlowering);
                    } else if (age >= 60 && age <= 80) {
                        // Female Age 60–80 yr
                        score = -0.22 + (0.0002 * sbp) + (0.0003 * wc) + (0.0012 * fpg) +
                                (0.0001 * tg) - (0.0004 * hdlc) - (0.0004 * egfr) + (0.0029 * smoking) + (0.2342 * antidiabetic) +
                                (0.0092 * antihypertensive) + (0.0143 * lipidlowering);
                    }
                }

                // --- Display Result ---
                scoreDisplay.textContent = score.toFixed(4); // Round to 4 decimal places
                resultContainer.classList.remove('hidden');
            });

            // Listen for form reset
            form.addEventListener('reset', () => {
                resultContainer.classList.add('hidden');
                errorMessage.classList.add('hidden');
            });

            // Helper function to show errors
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.classList.remove('hidden');
            }
        });
    </script>

</body>
</html>
